# ============================================================================
# Authentication Environment Configuration
# Copy this file to `.env.auth` and fill in the secrets before running locally.
# Never commit the populated `.env.auth` file.
# ============================================================================

# ---------------------------------------------------------------------------
# üîê JWT CONFIGURATION
# ---------------------------------------------------------------------------
# Algorithm used to sign tokens (RS256 recommended)
JWT_ALGORITHM=RS256
# Access token expiry in minutes
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
# Refresh token expiry in days
JWT_REFRESH_TOKEN_EXPIRE_DAYS=30
# Base64-encoded PKCS8 private key (see instructions below)
JWT_PRIVATE_KEY=
# Base64-encoded public key
JWT_PUBLIC_KEY=

# To generate a new RSA key pair (powershell):
#   $key = New-Object System.Security.Cryptography.RSACryptoServiceProvider 2048
#   [Convert]::ToBase64String($key.ExportPkcs8PrivateKey())
#   [Convert]::ToBase64String($key.ExportSubjectPublicKeyInfo())
# Or with OpenSSL:
#   openssl genpkey -algorithm RSA -pkeyopt rsa_keygen_bits:2048 -out jwt_private.pem
#   openssl rsa -in jwt_private.pem -pubout -out jwt_public.pem
#   base64 -w0 jwt_private.pem
#   base64 -w0 jwt_public.pem

# ---------------------------------------------------------------------------
# üö® SECURITY CONTROLS
# ---------------------------------------------------------------------------
# Maximum failed login attempts before lockout
MAX_LOGIN_ATTEMPTS=5
# Account lockout duration (minutes) after exceeding attempts
ACCOUNT_LOCKOUT_DURATION_MINUTES=15
# Password policy toggles
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBER=true
PASSWORD_REQUIRE_SPECIAL=true
PASSWORD_MIN_LENGTH=12

# ---------------------------------------------------------------------------
# üïí SESSION MANAGEMENT
# ---------------------------------------------------------------------------
# Idle timeout for UI/API sessions in minutes
SESSION_TIMEOUT_MINUTES=60
# Remember-me duration in days for refresh tokens
REMEMBER_ME_DAYS=30

# ---------------------------------------------------------------------------
# üë§ DEFAULT ADMIN BOOTSTRAP
# ---------------------------------------------------------------------------
# Default admin account created on startup if missing
DEFAULT_ADMIN_EMAIL=admin@example.com
DEFAULT_ADMIN_USERNAME=admin
DEFAULT_ADMIN_FIRST_NAME=System
DEFAULT_ADMIN_LAST_NAME=Administrator
# Leave blank to be prompted during setup (recommended)
DEFAULT_ADMIN_PASSWORD=

# ---------------------------------------------------------------------------
# ‚ö†Ô∏è REMINDERS
# ---------------------------------------------------------------------------
# - Do NOT commit the populated `.env.auth` file.
# - Rotate keys periodically and when credentials leak is suspected.
# - Sync values with Supabase service role permissions as needed.
